{% extends 'base.html' %}

{% block title %}Voice Settings | AI Podcasts Dashboard{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h1 class="mb-4">Voice Settings</h1>
        <p class="lead">Configure the ElevenLabs voice settings for your podcast audio.</p>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">ElevenLabs Voice Configuration</h5>
            </div>
            <div class="card-body">
                <form action="{{ url_for('update_voice') }}" method="POST">
                    <div class="mb-3">
                        <label for="voice_id" class="form-label">Voice ID</label>
                        <input type="text" class="form-control" id="voice_id" name="voice_id" 
                               value="{{ voices[0].voice_id if voices else '' }}" required>
                        <div class="form-text">
                            The ID of the ElevenLabs voice to use. You can find voice IDs in the 
                            <a href="https://elevenlabs.io/voice-library" target="_blank">ElevenLabs Voice Library</a>.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="stability" class="form-label">Stability ({{ voices[0].stability if voices else '0.5' }})</label>
                        <input type="range" class="form-range" id="stability" name="stability" 
                               min="0" max="1" step="0.05" value="{{ voices[0].stability if voices else 0.5 }}">
                        <div class="form-text">
                            Controls the random variation in voice. Lower values allow more variation, higher values make the voice more stable and consistent.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="similarity_boost" class="form-label">Similarity Boost ({{ voices[0].similarity_boost if voices else '0.5' }})</label>
                        <input type="range" class="form-range" id="similarity_boost" name="similarity_boost" 
                               min="0" max="1" step="0.05" value="{{ voices[0].similarity_boost if voices else 0.5 }}">
                        <div class="form-text">
                            Controls how closely the voice adheres to the voice's base character. Higher values make it sound more like the original voice.
                        </div>
                    </div>
                    
                    <hr class="my-4">
                    
                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-1"></i> Save Voice Settings
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="mb-0">Recommended Voices</h5>
            </div>
            <div class="card-body">
                <p class="mb-2">Here are some high-quality ElevenLabs voices you can try:</p>
                <ul class="list-group list-group-flush">
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Daniel <small class="text-muted">(Male)</small>
                        <button class="btn btn-sm btn-outline-primary copy-voice-id" data-voice-id="OnrYGRgL7f1nDQqkQQOe">
                            <i class="fas fa-copy"></i>
                        </button>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Rachel <small class="text-muted">(Female)</small>
                        <button class="btn btn-sm btn-outline-primary copy-voice-id" data-voice-id="21m00Tcm4TlvDq8ikWAM">
                            <i class="fas fa-copy"></i>
                        </button>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Adam <small class="text-muted">(Male)</small>
                        <button class="btn btn-sm btn-outline-primary copy-voice-id" data-voice-id="pNInz6obpgDQGcFmaJgB">
                            <i class="fas fa-copy"></i>
                        </button>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        Dorothy <small class="text-muted">(Female)</small>
                        <button class="btn btn-sm btn-outline-primary copy-voice-id" data-voice-id="ThT5KcBeYPX3keUQqHPh">
                            <i class="fas fa-copy"></i>
                        </button>
                    </li>
                </ul>
                <div class="mt-3">
                    <a href="https://elevenlabs.io/voice-library" target="_blank" class="btn btn-sm btn-outline-secondary w-100">
                        <i class="fas fa-external-link-alt me-1"></i> Browse Voice Library
                    </a>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Voice Settings Help</h5>
            </div>
            <div class="card-body">
                <div class="alert alert-info mb-0">
                    <h6><i class="fas fa-info-circle me-2"></i>Tips for Best Results</h6>
                    <ul class="mb-0">
                        <li>For news podcasts, use higher stability (0.7+) for clear narration</li>
                        <li>Start with moderate similarity boost (0.5) and adjust based on results</li>
                        <li>Professional male voices like Daniel work well for news content</li>
                        <li>Test your settings with a short script before generating full episodes</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Update stability and similarity boost labels when sliders change
    document.getElementById('stability').addEventListener('input', function() {
        document.querySelector('label[for="stability"]').innerHTML = 'Stability (' + this.value + ')';
    });
    
    document.getElementById('similarity_boost').addEventListener('input', function() {
        document.querySelector('label[for="similarity_boost"]').innerHTML = 'Similarity Boost (' + this.value + ')';
    });
    
    // Copy voice ID buttons
    document.querySelectorAll('.copy-voice-id').forEach(button => {
        button.addEventListener('click', function() {
            const voiceId = this.getAttribute('data-voice-id');
            document.getElementById('voice_id').value = voiceId;
            
            // Show feedback
            const originalHtml = this.innerHTML;
            this.innerHTML = '<i class="fas fa-check"></i>';
            this.classList.remove('btn-outline-primary');
            this.classList.add('btn-success');
            
            setTimeout(() => {
                this.innerHTML = originalHtml;
                this.classList.remove('btn-success');
                this.classList.add('btn-outline-primary');
            }, 1500);
        });
    });
</script>
{% endblock %}
